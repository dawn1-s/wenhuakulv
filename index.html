<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>《文化苦旅》的文化网络与空间轨迹研究</title>
  <!-- 引入依赖：Tailwind CSS（样式）、图标库、ECharts（可视化） -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
  <style>
    html, body { height: 100%; margin: 0; }
    /*背景图设置*/
    body {
      background-image: url("2.jpg");
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      background-attachment: fixed;
      position: relative;
    }

    /* 导航栏隐藏/显示动画 */
    .top-nav {
      position: fixed;
      left: 0;
      right: 0;
      top: 0;
      z-index: 40;
      transition: transform 280ms ease, opacity 220ms ease;
      will-change: transform, opacity;
      transform: translateY(0);
      opacity: 1;
      backdrop-filter: blur(6px); 
    }
    .top-nav--hidden {
      transform: translateY(-110%); /* 向上移出视口 */
      opacity: 0;
      pointer-events: none;
    }

    /* 磨砂玻璃（frosted glass）效果：更亮、更柔和的半透明并加强模糊 */
    .glass {
      background: linear-gradient(
        rgba(255,255,255,0.52),
        rgba(255,255,255,0.48)
      ); /* 轻微渐变让表面更自然 */
      border: 1px solid rgba(255,255,255,0.65);     /* 明亮边缘 */
      box-shadow: 0 8px 30px rgba(0,0,0,0.12);      /* 柔和阴影 */
      border-radius: 12px;
      -webkit-backdrop-filter: blur(12px) saturate(130%);
      backdrop-filter: blur(12px) saturate(130%);   /* 更强的模糊（磨砂感） */
      background-clip: padding-box;
      min-width: 0;
      color: #111827;
    }

    /* 便捷 padding 工具 */
    .glass.p-4 { padding: 1rem; }
    .glass.p-5 { padding: 1.25rem; }

    /* 保证页面内容在导航下方不被遮挡（header height + margin） */
    main { margin-top: 72px; } /* 若 header 高度不同，调整此值 */
    header, main, footer { position: relative; z-index: 10; }

    /* ====== 开场动画遮罩 ====== */
    #intro-overlay {
      position: fixed;
      inset: 0;
      z-index: 9999;
      background: radial-gradient(circle at 50% 40%, rgba(30,30,30,0.65), rgba(10,10,10,0.82));
      backdrop-filter: blur(6px);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 1;
    }

    #intro-overlay.hidden {
      display: none;
    }

    #intro-overlay.fade-out {
      animation: overlayFadeOut 1.2s ease forwards;
    }

    .intro-content {
      text-align: center;
      color: #f9fafb;
      padding: 0 20px;
    }

    /* 标题风格 */
    .intro-title {
      font-family: "STXingkai", "华文行楷", serif;
      font-size: clamp(2.6rem, 5vw, 3.8rem);
      letter-spacing: 0.22em;
      margin-bottom: 0.9rem;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,0.35));
    }

    /* 副标题风格 */
    .intro-subtitle {
      font-size: 0.95rem;
      letter-spacing: 0.28em;
      opacity: 0.92;
    }

    /* ====== 逐字浮现：每个字 ====== */
    .intro-char {
      display: inline-block;
      opacity: 0;
      transform: translateY(14px);
      filter: blur(2px);
      animation: charIn 720ms ease forwards;
    }

    /* “水墨”一点：第一个字稍微更慢更柔 */
    .intro-char.is-first {
      animation-duration: 900ms;
    }

    /* 动画：字出现 */
    @keyframes charIn {
      to {
        opacity: 1;
        transform: translateY(0);
        filter: blur(0);
      }
    }

    /* 遮罩淡出 */
    @keyframes overlayFadeOut {
      to {
        opacity: 0;
        visibility: hidden;
      }
    }
  </style>
</head>
<body class="bg-gray-50">
  <!-- 开场动画（首次访问播放） -->
    <div class="intro-content">
      <!-- 逐字浮现：把文本放到 data-text 里 -->
      <h1 id="intro-title" class="intro-title" data-text="文化苦旅"></h1>
      <p id="intro-subtitle" class="intro-subtitle" data-text="Knowledge Graph & Spatial Narrative"></p>
    </div>
  </div>
  <!-- 导航栏（替换原 sticky header） -->
  <header class="top-nav py-4" style="background-color: #ffffff;">
    <nav class="container mx-auto px-4 flex flex-wrap justify-between items-center">
      <h1 class="text-3xl md:text-4xl font-bold text-black" style="font-family: 'STXingkai', '华文行楷', serif;">文化苦旅</h1>
      <ul class="flex flex-wrap space-x-4 md:space-x-6 mt-2 md:mt-0">
        <li><a href="knowledge.html" class="hover:text-blue-300 transition-colors"> 知识图谱 </a></li>
        <li><a href="gis.html" class="hover:text-blue-300 transition-colors"> GIS地图 </a></li>
        <li><a href="heatmap.html" class="hover:text-blue-300 transition-colors"> 热力图 </a></li>
        <li><a href="reading.html" class="hover:text-blue-300 transition-colors"> 阅读分享 </a></li>
      </ul>
    </nav>
  </header>

  <!-- 主内容区 -->
  <main class="container mx-auto px-4 py-8">
    <!-- 系统简介：磨砂玻璃 -->
    <section id="intro" class="mb-16 glass p-5">
      <h2 class="text-2xl md:text-3xl font-bold mb-6 text-gray-800 border-b pb-2"> 《文化苦旅》的文化网络与空间轨迹研究 </h2>
      <p class="text-gray-600 text-lg leading-relaxed"> 简介内容：对该网站的具体描述 </p>
    </section>

    <!-- place1,2,3,4 分别对应4个地名 -->
    <section id="concepts" class="mb-16 glass p-5">
      <h2 class="text-2xl md:text-3xl font-bold mb-6 text-gray-800 border-b pb-2"> 地点查看 </h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        <a href="place1.html" class="glass border border-gray-200 rounded-lg p-5 hover:shadow-lg cursor-pointer transition-shadow block">
          <h3 class="text-xl font-bold text-blue-700"> 都江堰 </h3>
          <p class="text-gray-500 mt-1"> 介绍 </p>
          <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mt-3"> 概念分类标签 </span>
        </a>

        <a href="place2.html" class="glass border border-gray-200 rounded-lg p-5 hover:shadow-lg cursor-pointer transition-shadow block">
          <h3 class="text-xl font-bold text-blue-700"> 莫高窟 </h3>
          <p class="text-gray-500 mt-1"> 介绍 </p>
          <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mt-3"> 概念分类标签 </span>
        </a>

        <a href="place3.html" class="glass border border-gray-200 rounded-lg p-5 hover:shadow-lg cursor-pointer transition-shadow block">
          <h3 class="text-xl font-bold text-blue-700"> 地点三 </h3>
          <p class="text-gray-500 mt-1"> 介绍 </p>
          <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mt-3"> 概念分类标签 </span>
        </a>

        <a href="place4.html" class="glass border border-gray-200 rounded-lg p-5 hover:shadow-lg cursor-pointer transition-shadow block">
          <h3 class="text-xl font-bold text-blue-700"> 地点四 </h3>
          <p class="text-gray-500 mt-1"> 介绍 </p>
          <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mt-3"> 概念分类标签 </span>
        </a>
      </div>
    </section>

  <!-- 页脚：移除深色背景改为磨砂（如需保持深色可调整颜色） -->
  <footer class="text-white py-6 glass">
    <div class="container mx-auto px-4 text-center">
      <p> © 2025 网站名称 版权所有 </p>
      <p class="text-gray-400 text-sm mt-2"> 联系信息：3478049498@qq.com </p>
    </div>
  </footer>

  <!-- 引入数据和JS逻辑 -->
  <script>
    // 从 JSON 文件加载数据并通知页面
    fetch('文化苦旅知识图谱完成版.json')
      .then(res => res.json())
      .then(data => { window.conceptData = data; document.dispatchEvent(new Event('conceptDataLoaded')); })
      .catch(err => { console.error('加载数据失败', err); window.conceptData = {}; document.dispatchEvent(new Event('conceptDataLoaded')); });
  </script>
  <script>
    // 等待数据加载完成再初始化依赖数据的函数
    document.addEventListener('conceptDataLoaded', function() {
      // 1. 加载数据（从JSON获取，见上方fetch）
      const allData = window.conceptData || {};

      // 2. 点击概念卡片显示详情
      function showDetail(key) {
        const data = allData[key];
        if (!data) return;

        // 填充详情内容
        document.getElementById('detail-title').textContent = data.title;
        document.getElementById('detail-explain').textContent = data.explain;

        // 填充表格内容
        let tableHtml = '';
        data.tableData.forEach(item => {
          tableHtml += `
            <tr>
              <td class="border border-gray-300 px-4 py-3"> ${item.col1} </td>
              <td class="border border-gray-300 px-4 py-3"> ${item.col2} </td>
              <td class="border border-gray-300 px-4 py-3"> ${item.col3} </td>
              <td class="border border-gray-300 px-4 py-3"> ${item.col4} </td>
            </tr>
          `;
        });
        document.getElementById('detail-table').innerHTML = tableHtml;

        // 显示详情区并平滑滚动
        document.getElementById('detail-section').classList.remove('hidden');
        document.getElementById('detail-section').scrollIntoView({ behavior: 'smooth' });
      }

      // 将 showDetail 暴露到全局（如果页面有其他触发器需要访问）
      window.showDetail = showDetail;
    });

    // 3. 初始化ECharts可视化图表
    window.onload = function() {
      // 图表1：概念关系图（树状图示例）
      const chart1 = echarts.init(document.getElementById('chart1'));
      const chart1Option = {
        title: { text: '{{图表1标题}}', left: 'center' },
        tooltip: { trigger: 'item' },
        series: [{
          type: 'tree',
          data: [{{图表1数据，按ECharts格式填充}}],
          label: { position: 'left' },
          expandAndCollapse: true,
          animationDuration: 500
        }]
      };
      chart1.setOption(chart1Option);

      // 图表2：统计图表（柱状图示例）
      const chart2 = echarts.init(document.getElementById('chart2'));
      const chart2Option = {
        title: { text: '{{图表2标题}}', left: 'center' },
        xAxis: { type: 'category', data: {{x轴数据数组}} },
        yAxis: { type: 'value' },
        series: [{
          type: 'bar',
          data: {{y轴数据数组}},
          itemStyle: { color: '#4299e1' }
        }]
      };
      chart2.setOption(chart2Option);

      // 窗口缩放时图表自适应
      window.addEventListener('resize', () => {
        chart1.resize();
        chart2.resize();
      });
    };

    <!-- 在 body 末尾添加：隐藏/显示导航的脚本 -->
    (function(){
      const header = document.querySelector('.top-nav');
      if (!header) return;
      let lastScroll = window.pageYOffset || document.documentElement.scrollTop;
      let ticking = false;

      function onScroll() {
        const current = window.pageYOffset || document.documentElement.scrollTop;
        const delta = current - lastScroll;

        // 向下滚动且已超过阈值：隐藏；向上滚动：显示
        if (Math.abs(delta) > 5) {
          if (delta > 0 && current > 80) {
            header.classList.add('top-nav--hidden');
          } else {
            header.classList.remove('top-nav--hidden');
          }
          lastScroll = current;
        }
        ticking = false;
      }

      window.addEventListener('scroll', () => {
        if (!ticking) {
          window.requestAnimationFrame(onScroll);
          ticking = true;
        }
      }, { passive: true });

      // 可选：在窗口大小改变时重新计算 main 顶部间距（确保内容不被遮挡）
      window.addEventListener('resize', () => {
        const h = header.getBoundingClientRect().height;
        document.querySelector('main').style.marginTop = (h + 8) + 'px';
      });
      // 立即设置一次
      document.querySelector('main').style.marginTop = (header.getBoundingClientRect().height + 8) + 'px';
    })();
  </script>

  <script>
    (function () {
      const KEY = "introPlayed_v1"; // 改版本号可以让它重新播放一次
      const overlay = document.getElementById("intro-overlay");
      const titleEl = document.getElementById("intro-title");
      const subEl = document.getElementById("intro-subtitle");

      if (!overlay || !titleEl || !subEl) return;

      // 只在第一次访问播放
      const played = localStorage.getItem(KEY) === "1";
      if (played) {
        overlay.classList.add("hidden");
        return;
      }

      // 显示遮罩并锁滚动
      overlay.classList.remove("hidden");
      document.body.style.overflow = "hidden";

      // 逐字渲染函数
      function typeChars(el, text, baseDelay = 90, startDelay = 0) {
        el.textContent = ""; // 清空
        const chars = Array.from(text);

        chars.forEach((ch, i) => {
          const span = document.createElement("span");
          span.className = "intro-char" + (i === 0 ? " is-first" : "");
          span.textContent = ch;

          // 每个字延迟不同 => 逐字浮现
          span.style.animationDelay = (startDelay + i * baseDelay) + "ms";

          el.appendChild(span);
        });

        // 返回总时长（粗略）
        return startDelay + chars.length * baseDelay + 900;
      }

      // 取 data-text
      const titleText = titleEl.getAttribute("data-text") || "";
      const subText = subEl.getAttribute("data-text") || "";

      // 执行逐字动画：标题先，副标题后
      const tEnd = typeChars(titleEl, titleText, 140, 120);
      const sEnd = typeChars(subEl, subText, 42, tEnd - 300);

      // 总时长：副标题结束后再停一小会儿
      const total = sEnd + 700;

      // 淡出并解锁
      window.addEventListener("load", () => {
        setTimeout(() => {
          overlay.classList.add("fade-out");
        }, total - 900);

        setTimeout(() => {
          // 移除遮罩 & 解锁
          overlay.classList.add("hidden");
          document.body.style.overflow = "auto";

          // 记住：以后不再播放
          localStorage.setItem(KEY, "1");
        }, total + 400);
      });
    })();
  </script>
</body>

</html>
